import{d as E,f as a,I as h,g as y,J as D,K as O,E as P,o as S,c as N,k as C,m as T,L,A as k,r as _,j as A,w as F,e as K}from"./main.e15b396c.js";import{_ as M}from"./_plugin-vue_export-helper.cdc0426e.js";var g="https://js.stripe.com/v3",R=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,w="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",B=function(){for(var n=document.querySelectorAll('script[src^="'.concat(g,'"]')),e=0;e<n.length;e++){var t=n[e];if(!!R.test(t.src))return t}return null},q=function(n){var e=n&&!n.advancedFraudSignals?"?advancedFraudSignals=false":"",t=document.createElement("script");t.src="".concat(g).concat(e);var o=document.head||document.body;if(!o)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return o.appendChild(t),t},U=function(n,e){!n||!n._registerWrapper||n._registerWrapper({name:"stripe-js",version:"2.0.0",startTime:e})},f=null,W=function(n){return f!==null||(f=new Promise(function(e,t){if(typeof window>"u"||typeof document>"u"){e(null);return}if(window.Stripe&&n&&console.warn(w),window.Stripe){e(window.Stripe);return}try{var o=B();o&&n?console.warn(w):o||(o=q(n)),o.addEventListener("load",function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}),o.addEventListener("error",function(){t(new Error("Failed to load Stripe.js"))})}catch(s){t(s);return}})),f},V=function(n,e,t){if(n===null)return null;var o=n.apply(void 0,e);return U(o,t),o},b=Promise.resolve().then(function(){return W(null)}),I=!1;b.catch(function(r){I||console.warn(r)});var x=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];I=!0;var o=Date.now();return b.then(function(s){return V(s,e,o)})};const v={STRIPE_NOT_LOADED:"Stripe v3 library is not loaded",INSTANCE_NOT_DEFINED:"Instance object is not defined. Make sure you initialized Stripe before creating elements",ELEMENTS_NOT_DEFINED:"Elements object is not defined. You can't create stripe element without it",ELEMENT_TYPE_NOT_DEFINED:"elementType is required. You can't create stripe element without it"},G=(r,n)=>{try{if(!window.Stripe)throw new Error(v.STRIPE_NOT_LOADED);return window.Stripe(r,n)}catch(e){return console.error(e),e}},J=(r,n)=>{try{if(!r)throw new Error(v.INSTANCE_NOT_DEFINED);return r.elements(n)}catch(e){return console.error(e),e}},X=(r,n,e)=>{try{if(!r)throw new Error(v.ELEMENTS_NOT_DEFINED);if(!n)throw new Error(v.ELEMENT_TYPE_NOT_DEFINED);return r.create(n,e)}catch(t){return console.error(t),t}};var $=(r,n)=>{const e=r.__vccOpts||r;for(const[t,o]of n)e[t]=o;return e};const Y=E({name:"StripeElement",props:{elements:{type:Object,required:!0},type:{type:String,default:()=>"card"},options:{type:Object,default:()=>({})}},setup(r,{emit:n}){const e=a(document.createElement("div")),t=a(),o=a(),{elements:s,type:l,options:c}=h(r);return y(()=>{const i=()=>{t.value=X(s.value,l.value,c.value),t.value.mount(e.value),o.value.appendChild(e.value)},p=(u,d)=>{n(u,d)},m=()=>{["change","ready","focus","blur","click","escape"].forEach(d=>{t.value.on(d,p.bind(null,d))})};try{i(),m()}catch(u){console.error(u)}}),D(()=>{var i,p;(i=t.value)==null||i.unmount(),(p=t.value)==null||p.destroy()}),O(c,()=>{var i;(i=t.value)==null||i.update(r.options)}),{stripeElement:t,domElement:e,mountPoint:o}}}),z={ref:"mountPoint"};function H(r,n,e,t,o,s){return S(),N("div",z,null,512)}var Z=$(Y,[["render",H]]);const Q=E({name:"StripeElements",props:{stripeKey:{type:String,required:!0},instanceOptions:{type:Object,default:()=>({})},elementsOptions:{type:Object,default:()=>({})}},setup(r){const{stripeKey:n,instanceOptions:e,elementsOptions:t}=h(r),o=a(),s=a(),l=P(()=>s.value?Object.keys(s.value).length>0:!1);return y(()=>{o.value=G(n.value,e.value),s.value=J(o.value,t.value)}),O(t,()=>{var c;(c=s.value)==null||c.update(t.value)}),{elements:s,instance:o,elementsUsable:l}}}),ee={key:0};function te(r,n,e,t,o,s){return r.elementsUsable?(S(),N("div",ee,[C(r.$slots,"default",{instance:r.instance,elements:r.elements})])):T("",!0)}var ne=$(Q,[["render",te]]);const re=E({name:"CardInput",components:{StripeElements:ne,StripeElement:Z},props:{name:String},setup(r){const n="pk_test_51NVxVrJg82UJsKGFHOifr6N61dc7PCAB5XMF4kx9T76XIULk8cjKKSOOWDCJZjaf0hBNEPNSygteb0MdAIA4otm400zK0aWWKq",e=a(""),t=a({}),o=a({}),s=a({}),l=a(!1),c=a(),i=a();return a(null),L(()=>{x(n).then(()=>{l.value=!0}),k.get("/user/setup-intent").then(({data:u})=>{e.value=u.client_secret})}),{stripeKey:n,stripeLoaded:l,instanceOptions:t,elementsOptions:o,cardOptions:s,card:c,elms:i,pay:()=>new Promise((m,u)=>{const d=c.value.stripeElement;i.value.instance.confirmCardSetup(e.value,{payment_method:{card:d,billing_details:{name:r.name}}}).then(j=>{m(j.setupIntent)})})}}});function oe(r,n,e,t,o,s){const l=_("StripeElement"),c=_("StripeElements");return r.stripeLoaded?(S(),A(c,{key:0,ref:"elms","stripe-key":r.stripeKey,"instance-options":r.instanceOptions,"elements-options":r.elementsOptions},{default:F(({elements:i,instance:p})=>[K(l,{ref:"card",elements:i,options:r.cardOptions,class:"form-input text-white"},null,8,["elements","options"])]),_:1},8,["stripe-key","instance-options","elements-options"])):T("",!0)}const ie=M(re,[["render",oe]]);export{ie as C};
